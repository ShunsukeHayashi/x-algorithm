<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="2700px" preserveAspectRatio="none" style="width:3077px;height:2700px;background:#FEFEFE;" version="1.1" viewBox="0 0 3077 2700" width="3077px" zoomAndPan="magnify"><title>Phoenix ML Model - Grok-based Transformer Architecture</title><defs/><g><rect fill="#FEFEFE" height="2700" style="stroke:none;stroke-width:1;" width="3077" x="0" y="0"/><g class="title" data-source-line="4"><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="712.2285" x="1178.071" y="37.1182">Phoenix ML Model - Grok-based Transformer Architecture</text></g><!--cluster Input Features--><g class="cluster" data-entity="Input Features" data-source-line="6" data-uid="ent0002" id="cluster_Input Features"><path d="M528.5,58.7373 L646.709,58.7373 A3.75,3.75 0 0 1 649.209,61.2373 L656.209,81.752 L2371.5,81.752 A2.5,2.5 0 0 1 2374,84.252 L2374,162.2673 A2.5,2.5 0 0 1 2371.5,164.7673 L528.5,164.7673 A2.5,2.5 0 0 1 526,162.2673 L526,61.2373 A2.5,2.5 0 0 1 528.5,58.7373" fill="#BBDEFB" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="526" x2="656.209" y1="81.752" y2="81.752"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="117.209" x="530" y="74.8125">Input Features</text></g><!--cluster Hash-Based Embedding Tables--><g class="cluster" data-entity="Hash-Based Embedding Tables" data-source-line="17" data-uid="ent0011" id="cluster_Hash-Based Embedding Tables"><path d="M810.5,213.7673 L1053.2119,213.7673 A3.75,3.75 0 0 1 1055.7119,216.2673 L1062.7119,236.782 L1455.5,236.782 A2.5,2.5 0 0 1 1458,239.282 L1458,309.2773 A2.5,2.5 0 0 1 1455.5,311.7773 L810.5,311.7773 A2.5,2.5 0 0 1 808,309.2773 L808,216.2673 A2.5,2.5 0 0 1 810.5,213.7673" fill="#B3E5FC" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="808" x2="1062.7119" y1="236.782" y2="236.782"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="241.7119" x="812" y="229.8425">Hash-Based Embedding Tables</text></g><!--cluster Embedding Lookup & Reduction--><g class="cluster" data-entity="Embedding Lookup . Reduction" data-source-line="23" data-uid="ent0015" id="cluster_Embedding Lookup . Reduction"><path d="M854.5,393.8773 L1105.8115,393.8773 A3.75,3.75 0 0 1 1108.3115,396.3773 L1115.3115,416.892 L2066.5,416.892 A2.5,2.5 0 0 1 2069,419.392 L2069,500.7773 A2.5,2.5 0 0 1 2066.5,503.2773 L854.5,503.2773 A2.5,2.5 0 0 1 852,500.7773 L852,396.3773 A2.5,2.5 0 0 1 854.5,393.8773" fill="#C8E6C9" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="852" x2="1115.3115" y1="416.892" y2="416.892"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="250.3115" x="856" y="409.9525">Embedding Lookup &amp; Reduction</text></g><!--cluster Transformer Input--><g class="cluster" data-entity="Transformer Input" data-source-line="46" data-uid="ent0028" id="cluster_Transformer Input"><path d="M1051.5,757.1473 L1198.7275,757.1473 A3.75,3.75 0 0 1 1201.2275,759.6473 L1208.2275,780.162 L1625.5,780.162 A2.5,2.5 0 0 1 1628,782.662 L1628,860.6773 A2.5,2.5 0 0 1 1625.5,863.1773 L1051.5,863.1773 A2.5,2.5 0 0 1 1049,860.6773 L1049,759.6473 A2.5,2.5 0 0 1 1051.5,757.1473" fill="#DCEDC8" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1049" x2="1208.2275" y1="780.162" y2="780.162"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="146.2275" x="1053" y="773.2225">Transformer Input</text></g><!--cluster Grok Transformer--><g class="cluster" data-entity="Grok Transformer" data-source-line="52" data-uid="ent0032" id="cluster_Grok Transformer"><path d="M697.5,605.3673 L838.2881,605.3673 A3.75,3.75 0 0 1 840.7881,607.8673 L847.7881,628.382 L1022.5,628.382 A2.5,2.5 0 0 1 1025,630.882 L1025,1421.5273 A2.5,2.5 0 0 1 1022.5,1424.0273 L697.5,1424.0273 A2.5,2.5 0 0 1 695,1421.5273 L695,607.8673 A2.5,2.5 0 0 1 697.5,605.3673" fill="#E1BEE7" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="695" x2="847.7881" y1="628.382" y2="628.382"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="139.7881" x="699" y="621.4425">Grok Transformer</text></g><!--cluster Output Head--><g class="cluster" data-entity="Output Head" data-source-line="84" data-uid="ent0040" id="cluster_Output Head"><path d="M790.5,1457.0273 L890.8398,1457.0273 A3.75,3.75 0 0 1 893.3398,1459.5273 L900.3398,1480.042 L1023.5,1480.042 A2.5,2.5 0 0 1 1026,1482.542 L1026,1888.6273 A2.5,2.5 0 0 1 1023.5,1891.1273 L790.5,1891.1273 A2.5,2.5 0 0 1 788,1888.6273 L788,1459.5273 A2.5,2.5 0 0 1 790.5,1457.0273" fill="#FFCCBC" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="788" x2="900.3398" y1="1480.042" y2="1480.042"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="99.3398" x="792" y="1473.1025">Output Head</text></g><!--cluster Action Predictions--><g class="cluster" data-entity="Action Predictions" data-source-line="91" data-uid="ent0045" id="cluster_Action Predictions"><path d="M13.5,1940.1273 L157.5215,1940.1273 A3.75,3.75 0 0 1 160.0215,1942.6273 L167.0215,1963.142 L1110.5,1963.142 A2.5,2.5 0 0 1 1113,1965.642 L1113,2374.6573 A2.5,2.5 0 0 1 1110.5,2377.1573 L13.5,2377.1573 A2.5,2.5 0 0 1 11,2374.6573 L11,1942.6273 A2.5,2.5 0 0 1 13.5,1940.1273" fill="#FFECB3" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="11" x2="167.0215" y1="1963.142" y2="1963.142"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="143.0215" x="15" y="1956.2025">Action Predictions</text></g><!--cluster pos_actions--><g class="cluster" data-entity="pos_actions" data-source-line="92" data-uid="ent0046" id="cluster_pos_actions"><rect fill="#FFFFFF" height="353.03" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="619" x="43" y="1992.1273"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="125.4668" x="289.7666" y="2008.2025">Positive Actions</text></g><!--cluster neg_actions--><g class="cluster" data-entity="neg_actions" data-source-line="105" data-uid="ent0057" id="cluster_neg_actions"><rect fill="#FFFFFF" height="229.02" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="379" x="702" y="1992.1273"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="132.7949" x="825.1025" y="2008.2025">Negative Actions</text></g><!--entity user_hashes--><g class="entity" data-entity="user_hashes" data-source-line="7" data-uid="ent0003" id="entity_user_hashes"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="180.9863" x="541.51" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87.4932" x="551.51" y="118.8125">User Hashes</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="160.9863" x="551.51" y="135.8271">[B, num_user_hashes]</text></g><!--entity hist_post_hashes--><g class="entity" data-entity="hist_post_hashes" data-source-line="8" data-uid="ent0004" id="entity_hist_post_hashes"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="201.4189" x="757.29" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="140.2393" x="767.29" y="118.8125">History Post Hashes</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="181.4189" x="767.29" y="135.8271">[B, S, num_item_hashes]</text></g><!--entity hist_auth_hashes--><g class="entity" data-entity="hist_auth_hashes" data-source-line="9" data-uid="ent0005" id="entity_hist_auth_hashes"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="216.2188" x="1230.89" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="157.7666" x="1240.89" y="118.8125">History Author Hashes</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="196.2188" x="1240.89" y="135.8271">[B, S, num_author_hashes]</text></g><!--entity hist_actions--><g class="entity" data-entity="hist_actions" data-source-line="10" data-uid="ent0006" id="entity_hist_actions"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="161.8594" x="1975.07" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="105.7246" x="1985.07" y="118.8125">History Actions</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="141.8594" x="1985.07" y="135.8271">[B, S, num_actions]</text></g><!--entity hist_ps--><g class="entity" data-entity="hist_ps" data-source-line="11" data-uid="ent0007" id="entity_hist_ps"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="186.4482" x="2171.78" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="166.4482" x="2181.78" y="118.8125">History Product Surface</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41.8975" x="2181.78" y="135.8271">[B, S]</text></g><!--entity cand_post_hashes--><g class="entity" data-entity="cand_post_hashes" data-source-line="12" data-uid="ent0008" id="entity_cand_post_hashes"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="201.624" x="994.19" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="160.9043" x="1004.19" y="118.8125">Candidate Post Hashes</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="181.624" x="1004.19" y="135.8271">[B, C, num_item_hashes]</text></g><!--entity cand_auth_hashes--><g class="entity" data-entity="cand_auth_hashes" data-source-line="13" data-uid="ent0009" id="entity_cand_auth_hashes"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="216.4238" x="1481.79" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="178.4316" x="1491.79" y="118.8125">Candidate Author Hashes</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="196.4238" x="1491.79" y="135.8271">[B, C, num_author_hashes]</text></g><!--entity cand_ps--><g class="entity" data-entity="cand_ps" data-source-line="14" data-uid="ent0010" id="entity_cand_ps"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="207.1133" x="1733.44" y="94.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="187.1133" x="1743.44" y="118.8125">Candidate Product Surface</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="42.1025" x="1743.44" y="135.8271">[B, C]</text></g><!--entity user_emb_table--><g class="entity" data-entity="user_emb_table" data-source-line="18" data-uid="ent0012" id="entity_user_emb_table"><path d="M823.98,259.7673 C823.98,249.7673 913,249.7673 913,249.7673 C913,249.7673 1002.02,249.7673 1002.02,259.7673 L1002.02,285.782 C1002.02,295.782 913,295.782 913,295.782 C913,295.782 823.98,295.782 823.98,285.782 L823.98,259.7673" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M823.98,259.7673 C823.98,269.7673 913,269.7673 913,269.7673 C913,269.7673 1002.02,269.7673 1002.02,259.7673" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="158.04" x="833.98" y="287.8425">User Embedding Table</text></g><!--entity post_emb_table--><g class="entity" data-entity="post_emb_table" data-source-line="19" data-uid="ent0013" id="entity_post_emb_table"><path d="M1037.03,259.7673 C1037.03,249.7673 1124.9973,249.7673 1124.9973,249.7673 C1124.9973,249.7673 1212.9646,249.7673 1212.9646,259.7673 L1212.9646,285.782 C1212.9646,295.782 1124.9973,295.782 1124.9973,295.782 C1124.9973,295.782 1037.03,295.782 1037.03,285.782 L1037.03,259.7673" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1037.03,259.7673 C1037.03,269.7673 1124.9973,269.7673 1124.9973,269.7673 C1124.9973,269.7673 1212.9646,269.7673 1212.9646,259.7673" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="155.9346" x="1047.03" y="287.8425">Post Embedding Table</text></g><!--entity auth_emb_table--><g class="entity" data-entity="auth_emb_table" data-source-line="20" data-uid="ent0014" id="entity_auth_emb_table"><path d="M1248.27,259.7673 C1248.27,249.7673 1345.001,249.7673 1345.001,249.7673 C1345.001,249.7673 1441.7319,249.7673 1441.7319,259.7673 L1441.7319,285.782 C1441.7319,295.782 1345.001,295.782 1345.001,295.782 C1345.001,295.782 1248.27,295.782 1248.27,285.782 L1248.27,259.7673" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1248.27,259.7673 C1248.27,269.7673 1345.001,269.7673 1345.001,269.7673 C1345.001,269.7673 1441.7319,269.7673 1441.7319,259.7673" fill="none" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="173.4619" x="1258.27" y="287.8425">Author Embedding Table</text></g><!--entity block_user--><g class="entity" data-entity="block_user" data-source-line="24" data-uid="ent0016" id="entity_block_user"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="150.5049" x="867.75" y="440.0673"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="130.5049" x="877.75" y="464.1425">Block User Reduce</text></g><!--entity block_hist--><g class="entity" data-entity="block_hist" data-source-line="25" data-uid="ent0017" id="entity_block_hist"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="168.5791" x="1639.71" y="440.0673"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="148.5791" x="1649.71" y="464.1425">Block History Reduce</text></g><!--entity block_cand--><g class="entity" data-entity="block_cand" data-source-line="26" data-uid="ent0018" id="entity_block_cand"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="189.2441" x="1231.38" y="440.0673"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="169.2441" x="1241.38" y="464.1425">Block Candidate Reduce</text></g><g class="entity" data-entity="GMN19" data-source-line="29" data-uid="ent0020" id="entity_GMN19"><path d="M1053.24,437.7773 L1053.24,454.5773 L1018.71,458.5773 L1053.24,462.5773 L1053.24,479.3759 A0,0 0 0 0 1053.24,479.3759 L1196.7688,479.3759 A0,0 0 0 0 1196.7688,479.3759 L1196.7688,447.7773 L1186.7688,437.7773 L1053.24,437.7773 A0,0 0 0 0 1053.24,437.7773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1186.7688,437.7773 L1186.7688,447.7773 L1196.7688,447.7773 L1186.7688,437.7773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.5288" x="1059.24" y="455.8471">Output: [B, 1, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.0684" x="1059.24" y="471.6464">Concat + Project</text></g><g class="entity" data-entity="GMN22" data-source-line="34" data-uid="ent0023" id="entity_GMN22"><path d="M1843.47,429.8773 L1843.47,454.5773 L1808.44,458.5773 L1843.47,462.5773 L1843.47,487.2753 A0,0 0 0 0 1843.47,487.2753 L2052.5257,487.2753 A0,0 0 0 0 2052.5257,487.2753 L2052.5257,439.8773 L2042.5257,429.8773 L1843.47,429.8773 A0,0 0 0 0 1843.47,429.8773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2042.5257,429.8773 L2042.5257,439.8773 L2052.5257,439.8773 L2042.5257,429.8773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.5225" x="1849.47" y="447.9471">Output: [B, S, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.0557" x="1849.47" y="463.7464">Post + Author + Action + PS</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.0684" x="1849.47" y="479.5458">Concat + Project</text></g><g class="entity" data-entity="GMN25" data-source-line="40" data-uid="ent0026" id="entity_GMN25"><path d="M1455.59,429.8773 L1455.59,454.5773 L1420.83,458.5773 L1455.59,462.5773 L1455.59,487.2753 A0,0 0 0 0 1455.59,487.2753 L1604.4001,487.2753 A0,0 0 0 0 1604.4001,487.2753 L1604.4001,439.8773 L1594.4001,429.8773 L1455.59,429.8773 A0,0 0 0 0 1455.59,429.8773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1594.4001,429.8773 L1594.4001,439.8773 L1604.4001,439.8773 L1594.4001,429.8773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.6938" x="1461.59" y="447.9471">Output: [B, C, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.8101" x="1461.59" y="463.7464">Post + Author + PS</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.0684" x="1461.59" y="479.5458">Concat + Project</text></g><!--entity emb_user--><g class="entity" data-entity="emb_user" data-source-line="47" data-uid="ent0029" id="entity_emb_user"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="135.1787" x="1065.41" y="793.1473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="115.1787" x="1075.41" y="817.2225">User Embedding</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.0293" x="1075.41" y="834.2371">[B, 1, D]</text></g><!--entity emb_hist--><g class="entity" data-entity="emb_hist" data-source-line="48" data-uid="ent0030" id="entity_emb_hist"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="160.5469" x="1451.73" y="793.1473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="140.5469" x="1461.73" y="817.2225">History Embeddings</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.6992" x="1461.73" y="834.2371">[B, S, D]</text></g><!--entity emb_cand--><g class="entity" data-entity="emb_cand" data-source-line="49" data-uid="ent0031" id="entity_emb_cand"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="181.2119" x="1235.39" y="793.1473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="161.2119" x="1245.39" y="817.2225">Candidate Embeddings</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.9043" x="1245.39" y="834.2371">[B, C, D]</text></g><!--entity attn--><g class="entity" data-entity="attn" data-source-line="53" data-uid="ent0033" id="entity_attn"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="203.4766" x="805.26" y="1059.9573"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="145.6465" x="815.26" y="1084.0325">Multi-Head Attention</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="183.4766" x="815.26" y="1101.0471">(with Candidate Isolation)</text></g><!--entity ffn--><g class="entity" data-entity="ffn" data-source-line="54" data-uid="ent0034" id="entity_ffn"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="180.3506" x="816.82" y="1272.9973"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="160.3506" x="826.82" y="1297.0725">Feed-Forward Network</text></g><!--entity ln1--><g class="entity" data-entity="ln1" data-source-line="55" data-uid="ent0035" id="entity_ln1"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.2842" x="855.86" y="1174.9873"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.2842" x="865.86" y="1199.0625">Layer Norm</text></g><!--entity ln2--><g class="entity" data-entity="ln2" data-source-line="56" data-uid="ent0036" id="entity_ln2"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.2842" x="855.86" y="1371.0173"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.2842" x="865.86" y="1395.0925">Layer Norm</text></g><g class="entity" data-entity="GMN37" data-source-line="59" data-uid="ent0038" id="entity_GMN37"><path d="M711.46,641.3673 L711.46,998.9523 A0,0 0 0 0 711.46,998.9523 L887.61,998.9523 L902.3,1059.4673 L895.61,998.9523 L1008.545,998.9523 A0,0 0 0 0 1008.545,998.9523 L1008.545,651.3673 L998.545,641.3673 L711.46,641.3673 A0,0 0 0 0 711.46,641.3673" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M998.545,641.3673 L998.545,651.3673 L1008.545,651.3673 L998.545,641.3673" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="9.1406" x="717.46" y="659.4371">&#160;&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.1206" x="726.6006" y="659.4371">Attention Mask Pattern</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="717.46" y="675.2364">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="48.7881" x="726.6006" y="691.0358">Keys &#8594;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.0596" x="740.3116" y="706.8351">&#9474; User &#9474; Hist &#9474; Cands &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="254.6299" x="726.6006" y="722.6344">&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.8604" x="726.6006" y="738.4337">Q U &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; &#10007;&#10007;&#10007;  &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.1084" x="726.6006" y="754.233">u H &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; &#10007;&#10007;&#10007;  &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.4243" x="726.6006" y="770.0323">e i &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; &#10007;&#10007;&#10007;  &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161.4336" x="726.6006" y="785.8317">r s &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; &#10007;&#10007;&#10007;  &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.8027" x="726.6006" y="801.631">i t &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; &#10007;&#10007;&#10007;  &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="266.9443" x="726.6006" y="817.4303">e &#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9532;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.2759" x="726.6006" y="833.2296">s  C &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.041" x="726.6006" y="849.0289">a  a &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.3086" x="726.6006" y="864.8282">n n &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="166.0547" x="726.6006" y="880.6276">d d &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.1958" x="726.6006" y="896.4269">s i &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.2651" x="717.46" y="912.2262">&#9660;  d &#9474; &#10003;   &#9474; &#10003;&#10003;&#10003; &#9474; diag &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.5913" x="726.6006" y="928.0255">s  &#9474;      &#9474;      &#9474;       &#9474;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="717.46" y="943.8248">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.5181" x="726.6006" y="959.6241">&#10003; = Can attend</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.2437" x="726.6006" y="975.4235">&#10007; = Cannot attend</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.0698" x="726.6006" y="991.2228">diag = Self only</text></g><!--entity ln_out--><g class="entity" data-entity="ln_out" data-source-line="85" data-uid="ent0041" id="entity_ln_out"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.2842" x="855.86" y="1493.0273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.2842" x="865.86" y="1517.1025">Layer Norm</text></g><!--entity extract_cand--><g class="entity" data-entity="extract_cand" data-source-line="86" data-uid="ent0042" id="entity_extract_cand"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="206.0742" x="803.96" y="1591.0473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="186.0742" x="813.96" y="1615.1225">Extract Candidate Outputs</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.9043" x="813.96" y="1632.1371">[B, C, D]</text></g><!--entity unembed--><g class="entity" data-entity="unembed" data-source-line="87" data-uid="ent0043" id="entity_unembed"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="191.999" x="811" y="1706.0773"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="171.999" x="821" y="1730.1525">Unembedding Projection</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="134.75" x="821" y="1747.1671">[D &#215; num_actions]</text></g><!--entity logits--><g class="entity" data-entity="logits" data-source-line="88" data-uid="ent0044" id="entity_logits"><rect fill="#FFFFFF" height="54.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="162.0645" x="825.97" y="1821.0973"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="90.166" x="835.97" y="1845.1725">Action Logits</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="142.0645" x="835.97" y="1862.1871">[B, C, num_actions]</text></g><!--entity p_fav--><g class="entity" data-entity="p_fav" data-source-line="93" data-uid="ent0047" id="entity_p_fav"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="94.9424" x="66.53" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74.9424" x="76.53" y="2060.2025">P(favorite)</text></g><!--entity p_reply--><g class="entity" data-entity="p_reply" data-source-line="94" data-uid="ent0048" id="entity_p_reply"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="76.3213" x="196.84" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="56.3213" x="206.84" y="2060.2025">P(reply)</text></g><!--entity p_rt--><g class="entity" data-entity="p_rt" data-source-line="95" data-uid="ent0049" id="entity_p_rt"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="85.502" x="308.25" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65.502" x="318.25" y="2060.2025">P(repost)</text></g><!--entity p_quote--><g class="entity" data-entity="p_quote" data-source-line="96" data-uid="ent0050" id="entity_p_quote"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="81.0928" x="428.45" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="61.0928" x="438.45" y="2060.2025">P(quote)</text></g><!--entity p_click--><g class="entity" data-entity="p_click" data-source-line="97" data-uid="ent0051" id="entity_p_click"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="71.7139" x="67.14" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="51.7139" x="77.14" y="2184.2125">P(click)</text></g><!--entity p_pc--><g class="entity" data-entity="p_pc" data-source-line="98" data-uid="ent0052" id="entity_p_pc"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="124.7539" x="173.62" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="104.7539" x="183.62" y="2184.2125">P(profile_click)</text></g><!--entity p_vv--><g class="entity" data-entity="p_vv" data-source-line="99" data-uid="ent0053" id="entity_p_vv"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="119.668" x="333.17" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="99.668" x="343.17" y="2184.2125">P(video_view)</text></g><!--entity p_pe--><g class="entity" data-entity="p_pe" data-source-line="100" data-uid="ent0054" id="entity_p_pe"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="141.4883" x="488.26" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="121.4883" x="498.26" y="2184.2125">P(photo_expand)</text></g><!--entity p_share--><g class="entity" data-entity="p_share" data-source-line="101" data-uid="ent0055" id="entity_p_share"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="80.0332" x="66.98" y="2284.1473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="60.0332" x="76.98" y="2308.2225">P(share)</text></g><!--entity p_follow--><g class="entity" data-entity="p_follow" data-source-line="102" data-uid="ent0056" id="entity_p_follow"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="137.2295" x="182.39" y="2284.1473"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="117.2295" x="192.39" y="2308.2225">P(follow_author)</text></g><!--entity p_ni--><g class="entity" data-entity="p_ni" data-source-line="106" data-uid="ent0058" id="entity_p_ni"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="143.6758" x="726.16" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="123.6758" x="736.16" y="2060.2025">P(not_interested)</text></g><!--entity p_block--><g class="entity" data-entity="p_block" data-source-line="107" data-uid="ent0059" id="entity_p_block"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.8135" x="904.59" y="2036.1273"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="112.8135" x="914.59" y="2060.2025">P(block_author)</text></g><!--entity p_mute--><g class="entity" data-entity="p_mute" data-source-line="108" data-uid="ent0060" id="entity_p_mute"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="132.5059" x="731.75" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="112.5059" x="741.75" y="2184.2125">P(mute_author)</text></g><!--entity p_report--><g class="entity" data-entity="p_report" data-source-line="109" data-uid="ent0061" id="entity_p_report"><rect fill="#FFFFFF" height="37.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="84.1826" x="898.91" y="2160.1373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="64.1826" x="908.91" y="2184.2125">P(report)</text></g><g class="entity" data-entity="GMN90" data-source-line="152" data-uid="ent0091" id="entity_GMN90"><path d="M1129.49,2134.1473 L1129.49,2223.1439 L1360.5086,2223.1439 L1360.5086,2144.1473 L1350.5086,2134.1473 L1129.49,2134.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1350.5086,2134.1473 L1350.5086,2144.1473 L1360.5086,2144.1473 L1350.5086,2134.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.2305" x="1135.49" y="2152.2171">Positive Weights</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.6777" x="1135.49" y="2168.0164">These contribute positively</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="84.6206" x="1135.49" y="2183.8158">to final score</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="1135.49" y="2199.6151">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="210.0186" x="1135.49" y="2215.4144">Score += &#931;(weight &#215; P(action))</text></g><g class="entity" data-entity="GMN93" data-source-line="160" data-uid="ent0094" id="entity_GMN93"><path d="M1395.86,2134.1473 L1395.86,2223.1439 L1622.1432,2223.1439 L1622.1432,2144.1473 L1612.1432,2134.1473 L1395.86,2134.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1612.1432,2134.1473 L1612.1432,2144.1473 L1622.1432,2144.1473 L1612.1432,2134.1473" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.0352" x="1401.86" y="2152.2171">Negative Weights</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="203.3726" x="1401.86" y="2168.0164">These subtract from final score</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197.958" x="1401.86" y="2183.8158">to suppress unwanted content</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="1401.86" y="2199.6151">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.2832" x="1401.86" y="2215.4144">Score -= &#931;(weight &#215; P(action))</text></g><g class="entity" data-entity="GMN96" data-source-line="168" data-uid="ent0097" id="entity_GMN96"><path d="M2755.62,390.3773 L2755.62,526.7718 L3070.3705,526.7718 L3070.3705,400.3773 L3060.3705,390.3773 L2755.62,390.3773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M3060.3705,390.3773 L3060.3705,400.3773 L3070.3705,400.3773 L3060.3705,390.3773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="135.3257" x="2761.62" y="408.4471">Block User Reduce</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2761.62" y="424.2464">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="214.4238" x="2761.62" y="440.0458">Input: [B, num_user_hashes, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="262.7549" x="2761.62" y="455.8451">Reshape: [B, 1, num_user_hashes &#215; D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.4644" x="2761.62" y="471.6444">Project: [B, 1, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2761.62" y="487.4437">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="293.7505" x="2761.62" y="503.243">Projection matrix: [num_user_hashes&#215;D, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.042" x="2761.62" y="519.0423">Default: num_user_hashes = 2</text></g><g class="entity" data-entity="GMN99" data-source-line="179" data-uid="ent0100" id="entity_GMN99"><path d="M2421.39,358.7773 L2421.39,558.3691 L2720.6078,558.3691 L2720.6078,368.7773 L2710.6078,358.7773 L2421.39,358.7773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2710.6078,358.7773 L2710.6078,368.7773 L2720.6078,368.7773 L2710.6078,358.7773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.7749" x="2427.39" y="376.8471">Block History Reduce</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2427.39" y="392.6464">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87.4453" x="2427.39" y="408.4458">Concatenate:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="261.6377" x="2427.39" y="424.2451">- Post embeddings [B, S, num_item&#215;D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="278.2178" x="2427.39" y="440.0444">- Author embeddings [B, S, num_auth&#215;D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197.3994" x="2427.39" y="455.8437">- Action embeddings [B, S, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="258.4448" x="2427.39" y="471.643">- Product surface embeddings [B, S, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2427.39" y="487.4423">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.0864" x="2427.39" y="503.2417">Project: [B, S, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2427.39" y="519.041">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.8291" x="2427.39" y="534.8403">Default: num_item_hashes = 2</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.043" x="2463.9525" y="550.6396">num_author_hashes = 2</text></g><g class="entity" data-entity="GMN102" data-source-line="194" data-uid="ent0103" id="entity_GMN102"><path d="M2087.3,366.6773 L2087.3,550.4698 L2386.7082,550.4698 L2386.7082,376.6773 L2376.7082,366.6773 L2087.3,366.6773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2376.7082,366.6773 L2376.7082,376.6773 L2386.7082,376.6773 L2376.7082,366.6773" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.1763" x="2093.3" y="384.7471">Block Candidate Reduce</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2093.3" y="400.5464">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87.4453" x="2093.3" y="416.3458">Concatenate:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="261.8281" x="2093.3" y="432.1451">- Post embeddings [B, C, num_item&#215;D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="278.4082" x="2093.3" y="447.9444">- Author embeddings [B, C, num_auth&#215;D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="258.6353" x="2093.3" y="463.7437">- Product surface embeddings [B, C, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2093.3" y="479.543">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.2769" x="2093.3" y="495.3423">Project: [B, C, D]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="2093.3" y="511.1417">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.8291" x="2093.3" y="526.941">Default: num_item_hashes = 2</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.043" x="2129.8625" y="542.7403">num_author_hashes = 2</text></g><!--link user_hashes to user_emb_table--><g class="link" data-entity-1="user_hashes" data-entity-2="user_emb_table" data-source-line="114" data-uid="lnk62" id="link_user_hashes_user_emb_table"><path d="M681.91,149.2173 C735.69,177.7373 815.0396,219.8156 865.5796,246.6256" fill="none" id="user_hashes-to-user_emb_table" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="870.88,249.4373,864.8039,241.6861,866.463,247.0942,861.0549,248.7533,870.88,249.4373" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.0361" x="773.5" y="194.8371">Lookup</text></g><!--link hist_post_hashes to post_emb_table--><g class="link" data-entity-1="hist_post_hashes" data-entity-2="post_emb_table" data-source-line="115" data-uid="lnk63" id="link_hist_post_hashes_post_emb_table"><path d="M912.63,149.2473 C944.34,165.0073 984.84,185.7573 1020,205.7673 C1044.14,219.5073 1065.5709,232.9004 1085.9009,246.0404" fill="none" id="hist_post_hashes-to-post_emb_table" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1090.94,249.2973,1085.5527,241.0525,1086.7408,246.5832,1081.2101,247.7713,1090.94,249.2973" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.0361" x="1003.77" y="194.8371">Lookup</text></g><!--link hist_auth_hashes to auth_emb_table--><g class="link" data-entity-1="hist_auth_hashes" data-entity-2="auth_emb_table" data-source-line="116" data-uid="lnk64" id="link_hist_auth_hashes_auth_emb_table"><path d="M1340.06,149.0473 C1341.21,177.6273 1342.7888,216.7822 1343.8688,243.6222" fill="none" id="hist_auth_hashes-to-auth_emb_table" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1344.11,249.6173,1347.7449,240.4638,1343.909,244.6213,1339.7514,240.7854,1344.11,249.6173" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.0361" x="1343" y="194.8371">Lookup</text></g><!--link cand_post_hashes to post_emb_table--><g class="link" data-entity-1="cand_post_hashes" data-entity-2="post_emb_table" data-source-line="117" data-uid="lnk65" id="link_cand_post_hashes_post_emb_table"><path d="M1100.29,149.0473 C1106.05,177.6273 1113.9566,216.8952 1119.3566,243.7352" fill="none" id="cand_post_hashes-to-post_emb_table" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1120.54,249.6173,1122.6863,240.0051,1119.5538,244.7155,1114.8434,241.5831,1120.54,249.6173" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.0361" x="1111" y="194.8371">Lookup</text></g><!--link cand_auth_hashes to auth_emb_table--><g class="link" data-entity-1="cand_auth_hashes" data-entity-2="auth_emb_table" data-source-line="118" data-uid="lnk66" id="link_cand_auth_hashes_auth_emb_table"><path d="M1546.48,149.2173 C1499.59,177.7373 1430.916,219.5089 1386.846,246.3189" fill="none" id="cand_auth_hashes-to-auth_emb_table" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1381.72,249.4373,1391.4879,248.177,1385.9916,246.8386,1387.33,241.3424,1381.72,249.4373" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.0361" x="1490.44" y="194.8371">Lookup</text></g><!--link user_emb_table to block_user--><g class="link" data-entity-1="user_emb_table" data-entity-2="block_user" data-source-line="120" data-uid="lnk67" id="link_user_emb_table_block_user"><path d="M916.62,295.9473 C922.63,332.7973 933.6024,400.0258 939.1224,433.8058" fill="none" id="user_emb_table-to-block_user" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="940.09,439.7273,942.5862,430.2,939.2836,434.7928,934.6909,431.4902,940.09,439.7273" style="stroke:#000000;stroke-width:1;"/></g><!--link hist_ps to block_hist--><g class="link" data-entity-1="hist_ps" data-entity-2="block_hist" data-source-line="121" data-uid="lnk68" id="link_hist_ps_block_hist"><path d="M2228.39,148.9973 C2170.2,189.8173 2052.04,269.0473 1943,319.7773 C1893.3,342.8973 1872.85,330.3373 1826,358.7773 C1789.75,380.7873 1759.9943,413.194 1741.8543,435.124" fill="none" id="hist_ps-to-block_hist" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1738.03,439.7473,1746.8486,435.3619,1741.2169,435.8946,1740.6842,430.2628,1738.03,439.7473" style="stroke:#000000;stroke-width:1;"/></g><!--link hist_actions to block_hist--><g class="link" data-entity-1="hist_actions" data-entity-2="block_hist" data-source-line="122" data-uid="lnk69" id="link_hist_actions_block_hist"><path d="M2029.95,149.0273 C1964.83,214.6973 1800.4949,380.427 1745.7049,435.677" fill="none" id="hist_actions-to-block_hist" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1741.48,439.9373,1750.6575,436.3634,1745.0007,436.387,1744.9771,430.7302,1741.48,439.9373" style="stroke:#000000;stroke-width:1;"/></g><!--link post_emb_table to block_hist--><g class="link" data-entity-1="post_emb_table" data-entity-2="block_hist" data-source-line="123" data-uid="lnk70" id="link_post_emb_table_block_hist"><path d="M1168.27,296.1773 C1187.07,304.9473 1209.64,314.2273 1231,319.7773 C1400.02,363.7373 1463.58,285.2773 1622,358.7773 C1661.14,376.9373 1690.8614,411.6139 1708.0114,434.7939" fill="none" id="post_emb_table-to-block_hist" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1711.58,439.6173,1709.4426,430.0032,1708.6061,435.5978,1703.0115,434.7613,1711.58,439.6173" style="stroke:#000000;stroke-width:1;"/></g><!--link auth_emb_table to block_hist--><g class="link" data-entity-1="auth_emb_table" data-entity-2="block_hist" data-source-line="124" data-uid="lnk71" id="link_auth_emb_table_block_hist"><path d="M1441.92,291.7173 C1497.31,304.7773 1566.56,326.0273 1622,358.7773 C1658.51,380.3473 1688.2025,412.882 1706.2525,434.962" fill="none" id="auth_emb_table-to-block_hist" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1710.05,439.6073,1707.4507,430.1076,1706.8854,435.7362,1701.2569,435.171,1710.05,439.6073" style="stroke:#000000;stroke-width:1;"/></g><!--link cand_ps to block_cand--><g class="link" data-entity-1="cand_ps" data-entity-2="block_cand" data-source-line="126" data-uid="lnk72" id="link_cand_ps_block_cand"><path d="M1785.32,149.2673 C1707.34,190.1473 1556.16,272.8973 1438,358.7773 C1402.76,384.3873 1369.8535,414.7667 1348.4235,435.4867" fill="none" id="cand_ps-to-block_cand" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1344.11,439.6573,1353.3606,436.2771,1347.7046,436.1818,1347.7999,430.5258,1344.11,439.6573" style="stroke:#000000;stroke-width:1;"/></g><!--link post_emb_table to block_cand--><g class="link" data-entity-1="post_emb_table" data-entity-2="block_cand" data-source-line="127" data-uid="lnk73" id="link_post_emb_table_block_cand"><path d="M1149.25,295.9473 C1189.55,332.7973 1265.1227,401.8977 1302.0527,435.6777" fill="none" id="post_emb_table-to-block_cand" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1306.48,439.7273,1302.5389,430.7014,1302.7906,436.3526,1297.1394,436.6044,1306.48,439.7273" style="stroke:#000000;stroke-width:1;"/></g><!--link auth_emb_table to block_cand--><g class="link" data-entity-1="auth_emb_table" data-entity-2="block_cand" data-source-line="128" data-uid="lnk74" id="link_auth_emb_table_block_cand"><path d="M1342.71,295.9473 C1338.9,332.7973 1331.9566,399.9791 1328.4666,433.7591" fill="none" id="auth_emb_table-to-block_cand" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1327.85,439.7273,1332.7537,431.186,1328.3638,434.7538,1324.7961,430.3639,1327.85,439.7273" style="stroke:#000000;stroke-width:1;"/></g><!--link block_user to emb_user--><g class="link" data-entity-1="block_user" data-entity-2="emb_user" data-source-line="130" data-uid="lnk75" id="link_block_user_emb_user"><path d="M954.37,477.5773 C970.67,503.6273 1001.33,553.5173 1025,597.3673 C1062.43,666.7173 1099.3494,745.5032 1118.5594,787.4032" fill="none" id="block_user-to-emb_user" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1121.06,792.8573,1120.9452,783.0091,1118.9762,788.3122,1113.6731,786.3432,1121.06,792.8573" style="stroke:#000000;stroke-width:1;"/></g><!--link block_hist to emb_hist--><g class="link" data-entity-1="block_hist" data-entity-2="emb_hist" data-source-line="131" data-uid="lnk76" id="link_block_hist_emb_hist"><path d="M1714.48,477.4073 C1683.15,536.0773 1586.0063,718.0247 1548.8763,787.5547" fill="none" id="block_hist-to-emb_hist" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1546.05,792.8473,1553.8179,786.7926,1548.4053,788.4368,1546.7611,783.0242,1546.05,792.8473" style="stroke:#000000;stroke-width:1;"/></g><!--link block_cand to emb_cand--><g class="link" data-entity-1="block_cand" data-entity-2="emb_cand" data-source-line="132" data-uid="lnk77" id="link_block_cand_emb_cand"><path d="M1326,477.4073 C1326,536.0773 1326,717.3173 1326,786.8473" fill="none" id="block_cand-to-emb_cand" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1326,792.8473,1330,783.8473,1326,787.8473,1322,783.8473,1326,792.8473" style="stroke:#000000;stroke-width:1;"/></g><!--link emb_user to attn--><g class="link" data-entity-1="emb_user" data-entity-2="attn" data-source-line="134" data-uid="lnk78" id="link_emb_user_attn"><path d="M1121.11,847.4073 C1103.65,884.0873 1068.38,951.5073 1025,998.9573 C1003.45,1022.5273 979.6791,1040.6045 955.9291,1056.2645" fill="none" id="emb_user-to-attn" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="950.92,1059.5673,960.6356,1057.9524,955.0943,1056.8149,956.2318,1051.2736,950.92,1059.5673" style="stroke:#000000;stroke-width:1;"/></g><!--link emb_hist to attn--><g class="link" data-entity-1="emb_hist" data-entity-2="attn" data-source-line="135" data-uid="lnk79" id="link_emb_hist_attn"><path d="M1525.39,847.5373 C1513.97,887.2773 1486.52,961.8273 1434,998.9573 C1367.27,1046.1273 1148.6131,1069.1373 1015.1231,1079.1773" fill="none" id="emb_hist-to-attn" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1009.14,1079.6273,1018.4147,1082.941,1014.1259,1079.2523,1017.8147,1074.9636,1009.14,1079.6273" style="stroke:#000000;stroke-width:1;"/></g><!--link emb_cand to attn--><g class="link" data-entity-1="emb_cand" data-entity-2="attn" data-source-line="136" data-uid="lnk80" id="link_emb_cand_attn"><path d="M1317.15,847.5073 C1302.69,886.5273 1270.23,959.3473 1218,998.9573 C1157.58,1044.7773 1080.127,1065.534 1014.907,1075.804" fill="none" id="emb_cand-to-attn" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1008.98,1076.7373,1018.4927,1079.2887,1013.9191,1075.9596,1017.2483,1071.386,1008.98,1076.7373" style="stroke:#000000;stroke-width:1;"/></g><!--link attn to ln1--><g class="link" data-entity-1="attn" data-entity-2="ln1" data-source-line="138" data-uid="lnk81" id="link_attn_ln1"><path d="M907,1114.3473 C907,1133.2173 907,1152.1073 907,1168.6773" fill="none" id="attn-to-ln1" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1174.6773,911,1165.6773,907,1169.6773,903,1165.6773,907,1174.6773" style="stroke:#000000;stroke-width:1;"/></g><!--link ln1 to ffn--><g class="link" data-entity-1="ln1" data-entity-2="ffn" data-source-line="139" data-uid="lnk82" id="link_ln1_ffn"><path d="M907,1212.1073 C907,1229.3173 907,1249.3973 907,1266.6873" fill="none" id="ln1-to-ffn" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1272.6873,911,1263.6873,907,1267.6873,903,1263.6873,907,1272.6873" style="stroke:#000000;stroke-width:1;"/></g><!--link ffn to ln2--><g class="link" data-entity-1="ffn" data-entity-2="ln2" data-source-line="140" data-uid="lnk83" id="link_ffn_ln2"><path d="M907,1310.1173 C907,1327.3373 907,1347.4073 907,1364.6973" fill="none" id="ffn-to-ln2" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1370.6973,911,1361.6973,907,1365.6973,903,1361.6973,907,1370.6973" style="stroke:#000000;stroke-width:1;"/></g><!--link ln2 to ln_out--><g class="link" data-entity-1="ln2" data-entity-2="ln_out" data-source-line="142" data-uid="lnk84" id="link_ln2_ln_out"><path d="M907,1408.4873 C907,1431.2473 907,1464.2073 907,1486.8373" fill="none" id="ln2-to-ln_out" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1492.8373,911,1483.8373,907,1487.8373,903,1483.8373,907,1492.8373" style="stroke:#000000;stroke-width:1;"/></g><!--link ln_out to extract_cand--><g class="link" data-entity-1="ln_out" data-entity-2="extract_cand" data-source-line="143" data-uid="lnk85" id="link_ln_out_extract_cand"><path d="M907,1530.2673 C907,1546.8073 907,1565.7073 907,1584.5973" fill="none" id="ln_out-to-extract_cand" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1590.5973,911,1581.5973,907,1585.5973,903,1581.5973,907,1590.5973" style="stroke:#000000;stroke-width:1;"/></g><!--link extract_cand to unembed--><g class="link" data-entity-1="extract_cand" data-entity-2="unembed" data-source-line="144" data-uid="lnk86" id="link_extract_cand_unembed"><path d="M907,1645.5573 C907,1663.6973 907,1681.6473 907,1699.7573" fill="none" id="extract_cand-to-unembed" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1705.7573,911,1696.7573,907,1700.7573,903,1696.7573,907,1705.7573" style="stroke:#000000;stroke-width:1;"/></g><!--link unembed to logits--><g class="link" data-entity-1="unembed" data-entity-2="logits" data-source-line="145" data-uid="lnk87" id="link_unembed_logits"><path d="M907,1760.5873 C907,1778.7273 907,1796.6773 907,1814.7873" fill="none" id="unembed-to-logits" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="907,1820.7873,911,1811.7873,907,1815.7873,903,1811.7873,907,1820.7873" style="stroke:#000000;stroke-width:1;"/></g><!--link logits to pos_actions--><g class="link" data-entity-1="logits" data-entity-2="pos_actions" data-source-line="147" data-uid="lnk88" id="link_logits_pos_actions"><path d="M825.89,1868.4473 C786.92,1881.1573 741.87,1901.2973 710,1932.1273 C688.965,1952.4773 675.07,1982.2323 666.3825,2007.2036 C665.2966,2010.325 664.292,2013.3716 663.365,2016.3158 C662.9015,2017.7879 664.1813,2013.4874 663.7561,2014.9048" fill="none" id="logits-to-pos_actions" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="662.0323,2020.6518,668.4494,2013.1805,663.4688,2015.8626,660.7867,2010.882,662.0323,2020.6518" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="29.2437" x="742.71" y="1921.1971">Split</text></g><!--link logits to neg_actions--><g class="link" data-entity-1="logits" data-entity-2="neg_actions" data-source-line="148" data-uid="lnk89" id="link_logits_neg_actions"><path d="M981.2,1875.4673 C1007.79,1888.5273 1035.5,1907.0073 1053,1932.1273 C1060.7,1943.1798 1065.8213,1956.1517 1069.1667,1969.4289 C1070.8395,1976.0675 1072.0682,1982.7824 1072.9535,1989.3719 C1073.0641,1990.1956 1072.4417,1985.0616 1072.5418,1985.8809" fill="none" id="logits-to-neg_actions" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="1073.2695,1991.8367,1076.1485,1982.418,1072.6631,1986.8736,1068.2075,1983.3882,1073.2695,1991.8367" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="29.2437" x="1045.7" y="1921.1971">Split</text></g><!--link pos_actions to GMN90--><g class="link" data-entity-1="pos_actions" data-entity-2="GMN90" data-source-line="152" data-uid="lnk92" id="link_pos_actions_GMN90"><path d="M662.0066,2058.493 C662.0662,2058.5139 662.1261,2058.5348 662.1862,2058.5558 C662.4268,2058.6398 662.6718,2058.7252 662.9211,2058.8119 C663.9183,2059.1588 664.9837,2059.5271 666.1096,2059.9131 C668.3612,2060.6851 670.8544,2061.5279 673.525,2062.4123 C684.2075,2065.9498 697.73,2070.1523 710,2073.1473 C860.42,2109.8773 901.23,2103.4773 1053,2134.1473 C1077.71,2139.1373 1104.11,2144.8673 1129.19,2150.4873" fill="none" id="pos_actions-GMN90" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link neg_actions to GMN93--><g class="link" data-entity-1="neg_actions" data-entity-2="GMN93" data-source-line="160" data-uid="lnk95" id="link_neg_actions_GMN93"><path d="M1081.1087,2057.4419 C1081.3568,2057.4974 1081.6101,2057.554 1081.8686,2057.6118 C1082.9027,2057.8431 1084.02,2058.0933 1085.2166,2058.3618 C1087.6097,2058.8986 1090.3199,2059.5084 1093.3161,2060.185 C1105.3009,2062.8914 1121.8619,2066.6679 1141.0088,2071.1336 C1179.3025,2080.0648 1227.94,2091.7523 1271,2103.1473 C1318.86,2115.8173 1330.72,2119.4573 1378,2134.1473 C1383.72,2135.9273 1389.57,2137.7673 1395.48,2139.6573" fill="none" id="neg_actions-GMN93" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link GMN96 to block_user--><g class="link" data-entity-1="GMN96" data-entity-2="block_user" data-source-line="168" data-uid="lnk98" id="link_GMN96_block_user"><path d="M2825.4,390.0873 C2794.08,369.5873 2757.37,349.7773 2720.5,339.2773 C2675.96,326.5973 1095.93,320.7473 1053.5,339.2773 C1006.42,359.8473 970.43,411.4673 953.56,439.5873" fill="none" id="GMN96-block_user" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link GMN99 to block_hist--><g class="link" data-entity-1="GMN99" data-entity-2="block_hist" data-source-line="179" data-uid="lnk101" id="link_GMN99_block_hist"><path d="M2433.83,358.2773 C2418.43,350.5973 2402.51,344.0073 2386.5,339.2773 C2328.63,322.1973 1899.25,316.2173 1843.5,339.2773 C1793.93,359.7873 1754.16,411.9373 1735.52,440.0073" fill="none" id="GMN99-block_hist" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link GMN102 to block_cand--><g class="link" data-entity-1="GMN102" data-entity-2="block_cand" data-source-line="194" data-uid="lnk104" id="link_GMN102_block_cand"><path d="M2114.25,366.2473 C2094.16,355.1673 2072.9,345.5673 2051.5,339.2773 C1987.96,320.6073 1517.19,315.1973 1455.5,339.2773 C1403.39,359.6273 1359.61,411.8373 1338.87,439.9673" fill="none" id="GMN102-block_cand" style="stroke:#000000;stroke-width:1;stroke-dasharray:7,7;"/></g><g class="legend" data-source-line="207"><rect fill="none" height="299.249" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1;" width="283.3555" x="2775.015" y="2388.1573"/><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="169.791" x="2780.015" y="2407.2325">Phoenix Model Config</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="4.9219" x="2780.015" y="2424.2471">&#160;</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="205.6045" x="2780.015" y="2441.2618">&#8226; Transformer: Grok-1 based</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="273.3555" x="2780.015" y="2458.2764">&#8226; emb_size: D (embedding dimension)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="242.7441" x="2780.015" y="2475.2911">&#8226; history_seq_len: S (default 128)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="253.8936" x="2780.015" y="2492.3057">&#8226; candidate_seq_len: C (default 32)</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="131.585" x="2780.015" y="2509.3204">&#8226; num_actions: 14</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="161.3965" x="2780.015" y="2526.335">&#8226; num_user_hashes: 2</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="162.2441" x="2780.015" y="2543.3497">&#8226; num_item_hashes: 2</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="177.0439" x="2780.015" y="2560.3643">&#8226; num_author_hashes: 2</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="166.8721" x="2780.015" y="2577.379">&#8226; fprop_dtype: bfloat16</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="4.9219" x="2780.015" y="2594.3936">&#160;</text><text fill="#000000" font-family="Verdana" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="102.6553" x="2780.015" y="2611.4083">Key Features</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="232.5723" x="2780.015" y="2628.4229">&#8226; Candidate isolation in attention</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="229.9199" x="2780.015" y="2645.4376">&#8226; Hash-based embedding lookup</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="169.7227" x="2780.015" y="2662.4522">&#8226; Multi-action prediction</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="192.2881" x="2780.015" y="2679.4669">&#8226; Shared embedding tables</text></g><!--SRC=[jLdDRXit4BxlKqmTe7NW28MTDasDE42qakeWjkj62Nf80e7IKXAh5RbPSltJ8a3GGn-WBPfBJsqV8xVS-n1-af93xYxtHrQKjjRVSlZDS3WS3cVeZzISBYaaCM4ya0l64vAI9Op9P35BHSQZKCGYXHk3lda5WM8gfd0w5vIp2pW-WcCHqHWwy5Kg5fqnaJI29odXSYhI9KtXGJgPCqKdAajf42HQB9bHs7h8aqp1W193brjmezljzGTT-240_PTgFE4pFT3MKwc5718vf_8vVzQz1JnRZZ9D7CsH-68BY0IFK1TmoAGIwIMS2gagWePMbbPkMP4rrmoZHAFN27oGgRb8sqGIx6aADVHrGYUA2LuJPsc-84jPETLKHDb4mJ1BfsH2dJ1_TWtMaF28HKJHfft25NQQQ9Rhx5IARB5KkD9IAFOQItcQjaqpz9MJmIlFvypudIvwQ7yvfb74-0oUa75i7V1s__D1w1nGooV6bvt_rU2boz7bUAGCgSQ5HcpZGdkjud9sQkD3WvHy_hHA-94GYoo1Z-4nDORHBgBd5Txjtmc_R6wiRYmc2y3f8ToECpPKt5_j-Dp56Yp6hzfPoWLhC9bL2f2B2zsVijbSWPZMjG2uDxx_TQPqoDW7iyYxjw3tujwdu_kkEnHyGXJi69VuJe-FPCeZ5BjwW4BdnW33sW2udZkv8- -uRMe67Fux5T02hIg4QrHupv5zJ_7ZCWPWxHwziDyBxww8kuLhsRs5PiVbCvxOvYIvUnICPIJpEDjyfVIIEczOuKM3-PCovuv_ukWvzNUx_VuNpJaTPx5YdKDA8dYW5ELc3P_pxNEcvfwNFfGY9gRhfjrvIl6we06bKMSWqdEIHd12rRb85mYUJXlO8tAfBNcYTKD4p7VN8lOyVr4YCTvIQ85-KcWFnqGku5JtqfIZipZG8tefuUgddrrJ_rtz-gFTxUR1h1C-c6bBynJagDVv-wtt_054_VxB2Vq6dk9WLx__uXJHJ_RjMc_i6pnDCZZSd8a2svmf1Rav4mFr8UhzB_QLEWXSgqp4oCnJWvZt1dYkNnl08_tQ02xNh5a5VlNRMzXKF5ABFL1zG63k-rh0WTaHPhVH8YwRDKIote_L7Xpf08OqdeBWyUNgo6i3EvZGe-FJO126tR0Pdng1O2IoHg3iNwXKvtzUmBB2cz7I0iiZne_kd1PPWpisC1O-wy6xDysaCxFmkXHt2Xw96LErlCxdZh6_OW_7UPhIY5aecgKVTcytpQ9FFgRO6SsJupoHoaTn77MkxIav4wbEMsqSJqQwtGvCQH9VvYXihCJfGxW0gdRKoqoKOsAZ7JU9sMIHux3HZajICMKn7LNmoQGTVCOYAaPdZ9xdoBCLaqxcGeaHlKYqUnHILwWgvoGjfeID5HONSIpENLPVc1s9oF0ggA_j2PsHnjfoEbktjdg7ZHZNfnwLYXRwSzQEjhbMLIsajSENcQ8rj26jTefKUTuZd6EyCXx_YKdFE7NrcbUcGgTplrP3mBxBu8Dw2OhWQkbG0ti54uAhzK89hXTjrqgkbsBNIWvgap5OBuztTQT7nYpGBsVhVJMrQhqrFMgzRgA-J8o3AsLYxqgPjb0ffuDTHH9SZblGKOcIjw1RGJcdDQX9xNAUAgLWHKfWlh5faaZzmMUJSkgFe-lKKN-v1XuVziSgu9y8ViCwemloxjVAiA4xiB-vinGBjW_396RAx_RtRjwjTy693eCom8nsB9GIIvFKUg82p6kBIFyjDMMITENF4-rx52Q2gvIDzKOqZ8Z3GAq4J1adCSY9IB7K6fe7s3c0l__SFaT9vbGxtRPZtRmPb7LPJIDFUwjH4P_QD9BPs9x5qrIp-qgWLZ9B4XsVpF5vJdIiYd0AEd4lTUoyjuundJPBOwrWeupFgm0iy6mfMRioCnc21ZocEf8djAYeQoYZ3k9SVk1Lta59DQVuakXrkT3zDGdltlJSK3qw9Rhssc-CSG1xrq_KbOh5HAlt3_bSRGbCkVxiwsR75ij5YYEXTj-dDNk1E5TDjoDDD2YHTgvDfElFBwEalOng1zQjML0h1l9ksj10HGdNl39RRq2N_HK6hD_6R6J2yBrD6BQOS8s9mbOJXV-nYM8wCmsyXd519x_BnejiROSfc-LMkNhzXt-ti6zlkNS1xxbTlmdKadslDr8FjikqEc9BogNPomutjwuxalJbAAPS1qVOZkoaO7VlRWwRv0jK0iCIU7ilntbfzZxiVkPHlGssZxR9EpohLJig1YkxfZhrJ4QHkZHHOZoD1L6xTm9hjKVqihY-Tq7Hi9JknV9h562ke38D1yEhMFlFWj9YiKqaBCBUrTW9GbBK2QvtQ79GdnSFR6dMsIvmy0y0]--></g></svg>